// Generated by CoffeeScript 1.6.3
var Api, Logger, parallel, v4;

v4 = require('node-uuid').v4;

parallel = require('also').parallel;

Api = require('./api/api');

Logger = require('./logger/logger');

module.exports = function(config) {
  var log, title, uuid;
  title = config.title || 'Untitled Vertex';
  uuid = config.uuid || v4();
  log = Logger.create(config);
  return parallel([
    function() {
      if (config.api != null) {
        return Api.create(config, log).listen();
      }
    }
  ]).then(function(_arg) {
    var api;
    api = _arg[0];
    if (api != null) {
      return log.info({
        listen: api.server.address()
      }, 'api listening');
    }
  }, function(error) {
    log.fatal(error);
    return process.exit(1);
  });
};
